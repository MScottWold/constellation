(()=>{"use strict";function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}function n(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var e=function(){function e(t,n,i,o,s){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialX=this.x=this.cx=t,this.initialY=this.y=this.cy=n,this.id=i,this.canvas=o,this.mouse=s,this.wander=!0,this.rad=2*Math.PI/45*(Math.floor(45*Math.random())+1)}var i,o;return i=e,(o=[{key:"update",value:function(t){var n=this._distanceTo(this.mouse.x,this.mouse.y);this.mouse.x&&n<100&&!this.mouse.ignore?this.moveToMouse(t,n):this.wander?this._wander(t):this._returnToCenter(t)}},{key:"moveToMouse",value:function(t,n){var i,o,s=n||this._distanceTo(this.mouse.x,this.mouse.y);if(this.wander=!1,s<1)i=0,o=0;else{var r=9/s;i=-r*(this.x-this.mouse.x),o=-r*(this.y-this.mouse.y)}var a=e.speed*Math.min(t,33);this.x=this.x+i*a,this.y=this.y+o*a}},{key:"jumpToMouse",value:function(){this.x=this.mouse.x,this.y=this.mouse.y,this.wander=!1}},{key:"stretchToCanvas",value:function(t,n){var e=this.canvas.el.width,i=this.canvas.el.height;this.cx=this.cx/t*e,this.x=this.cx,this.cy=this.cy/n*i,this.y=this.cy}},{key:"scaleToArtboard",value:function(){var t=this.canvas.el.width,n=this.canvas.el.height,e=Math.min(t,n),i=this.initialX/100*e;t>n&&(i+=(t-n)/2);var o=this.initialY/100*e;n>t&&(o+=(n-t)/2),this.x=this.cx=i,this.y=this.cy=o}},{key:"twoClosestPoints",value:function(n){if(n.length<=2)return function(n){if(Array.isArray(n))return t(n)}(e=n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var i=Object.prototype.toString.call(n).slice(8,-1);return"Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i?Array.from(n):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(n,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var e,i,o,s=n[0],r=this._distanceTo(s.x,s.y),a=n[1],h=this._distanceTo(a.x,a.y);if(r>h){var l=[a,s];s=l[0],a=l[1];var c=[h,r];r=c[0],h=c[1]}for(var u=2;u<n.length;u++)i=n[u],(o=this._distanceTo(i.x,i.y))<r?(a=s,h=r,s=i,r=o):o<h&&(a=i,h=o);return[s,a]}},{key:"_wander",value:function(t){var n=this._distanceTo(this.cx,this.cy)<e.range&&Math.random()>.5?e.turnRadius:-e.turnRadius;this.rad=this.rad+n;var i=Math.cos(this.rad),o=Math.sin(this.rad),s=e.speed*Math.min(t,33);this.x=this.x+i*s,this.y=this.y+o*s}},{key:"_returnToCenter",value:function(t){var n=this._distanceTo(this.cx,this.cy),i=18/n,o=e.speed*Math.min(t,33),s=-i*(this.x-this.cx),r=-i*(this.y-this.cy);this.x=this.x+s*o,this.y=this.y+r*o,n<.25*e.range&&(this.wander=!0,this.rad=2*Math.PI/45*(Math.floor(45*Math.random())+1))}},{key:"_distanceTo",value:function(t,n){var e=Math.pow(this.x-t,2),i=Math.pow(this.y-n,2);return Math.sqrt(e+i)}}])&&n(i.prototype,o),e}();e.speed=.01,e.range=50,e.turnRadius=2*Math.PI/45;const i=e;function o(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.point=n}var n,e;return n=t,(e=[{key:"draw",value:function(n){n.beginPath(),n.arc(this.point.x,this.point.y,t.options.radius,0,2*Math.PI,!1),n.closePath(),this.point.wander?n.fillStyle=t.options.fillColor:n.fillStyle=t.options.altFillColor,n.fill(),n.stroke()}},{key:"label",value:function(t){t.beginPath(),t.font="12px Arial",t.fillStyle="black",t.fillText(this.point.id,this.point.x-3,this.point.y+13)}}])&&o(n.prototype,e),t}();s.options={fillColor:"white",altFillColor:"black",strokeColor:"black",radius:4};const r=s;function a(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function h(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(n,e){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a(this,t),n[0]instanceof i?this.points=n:this.points=n.map((function(t){return e[t]})),this.polygon=o}var n,e;return n=t,(e=[{key:"draw",value:function(t){t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var n=1;n<this.points.length;n++)t.lineTo(this.points[n].x,this.points[n].y);this.polygon?(t.closePath(),t.fill()):t.stroke()}},{key:"removePoint",value:function(t){this.points=this.points.filter((function(n){return n!==t}))}}])&&h(n.prototype,e),t}();l.options={strokeColor:"black",fillColor:"white",lineWidth:2};const c=l;function u(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}const f=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.x,this.y,this.mode="default",this.clicked=!1,this.ignore=!1}var n,e;return n=t,(e=[{key:"resetPos",value:function(){this.x=null,this.y=null,this.clicked=!1}},{key:"updatePos",value:function(t,n){this.x=t,this.y=n}},{key:"click",value:function(t,n){this.x=t,this.y=n,this.clicked=!0}},{key:"setToIgnore",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.ignore=!0,this.ignoreTimeout&&clearTimeout(this.ignoreTimeout),this.ignoreTimeout=setTimeout((function(){return t.ignore=!1}),n)}},{key:"near",value:function(t){var n=Math.pow(this.x-t.x,2),e=Math.pow(this.y-t.y,2);return Math.sqrt(n+e)<100}}])&&u(n.prototype,e),t}();function d(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}function p(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function y(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v={points:{},lines:[],polygons:[]};const m=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;p(this,t),this.canvas={},this.mouse=new f,this.modified=!1,this._initCanvas(n),this._initShapes(e),this._installListeners(),window.requestAnimationFrame(this._drawArt.bind(this))}var n,e;return n=t,(e=[{key:"changeMouseMode",value:function(t){this.mouse.mode=t}},{key:"toggleLines",value:function(){this.lines=[],this.noLines=!this.noLines}},{key:"destroyShapes",value:function(){this.polygons=[]}},{key:"resetArtboard",value:function(t){this._initShapes(t),this.modified=!1,this.noLines=!1}},{key:"_removePoint",value:function(t){this.points=this.points.filter((function(n){return n!==t})),this.vertices=this.vertices.filter((function(n){return n.point!==t})),this.lines.forEach((function(n){return n.removePoint(t)})),this.lines=this.lines.filter((function(t){return t.points.length>1})),this.polygons.forEach((function(n){return n.removePoint(t)})),this.polygons=this.polygons.filter((function(t){return t.points.length>2}))}},{key:"_addNewPoint",value:function(t,n){var e=this;this.modified=!0;var o=this.points.length>=1?this.points[this.points.length-1].id+1:0,s=new i(t,n,o,this.canvas,this.mouse);if(this.noLines)return this.points.push(s),void this.vertices.push(new r(s));var a=s.twoClosestPoints(this.points);this.points.push(s),this.vertices.push(new r(s)),a.forEach((function(t){e.lines.push(new c([t,s],e.points))}))}},{key:"_teleportPoints",value:function(){this.mouse.setToIgnore(),this.points.forEach((function(t){return t.jumpToMouse()}))}},{key:"_initCanvas",value:function(t){this.canvas.el=document.getElementById(t),this.canvas.el.width=window.innerWidth,this.canvas.el.height=window.innerHeight,this.canvas.ctx=this.canvas.el.getContext("2d")}},{key:"_initShapes",value:function(t){var n,e,o=this,s=t.points,a=t.lines,h=t.polygons,l=t.options;for(var u in l&&this._setShapeOptions(l),this.vertices=[],this.points=[],s){var f=(n=s[u],e=3,function(t){if(Array.isArray(t))return t}(n)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var i,o,s=[],r=!0,a=!1;try{for(e=e.call(t);!(r=(i=e.next()).done)&&(s.push(i.value),!n||s.length!==n);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==e.return||e.return()}finally{if(a)throw o}}return s}}(n,e)||function(t,n){if(t){if("string"==typeof t)return d(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?d(t,n):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=f[0],y=f[1],v=f[2],m=new i(p,y,Number(u),this.canvas,this.mouse);this.stretch?m.stretchToCanvas(100,100):m.scaleToArtboard(),this.points.push(m),v||this.vertices.push(new r(m))}this.lines=[],a.forEach((function(t){for(var n=0;n<t.length-1;n++)o.lines.push(new c([t[n],t[n+1]],o.points))})),this.polygons=h.map((function(t){return new c(t,o.points,!0)}))}},{key:"_setShapeOptions",value:function(t){var n=t.scaleDown,e=t.vertices,i=t.shapes,o=t.stretch;if(t.lineCap,this.stretch=o,r.options=Object.assign({},r.options,e),c.options=Object.assign({},c.options,i),n&&window.innerWidth<n.maxWidth){var s=n.factor;e&&(r.options.lineWidth=e.lineWidth/s,r.options.radius=e.radius/s),i&&(c.options.lineWidth=i.lineWidth/s)}}},{key:"_drawArt",value:function(t){var n=this,e=this.canvas.ctx;e.clearRect(0,0,this.canvas.el.width,this.canvas.el.height),e.lineWidth=c.options.lineWidth,e.strokeStyle=c.options.strokeColor,e.fillStyle=c.options.fillColor,c.options.lineCap&&(e.lineCap=c.options.lineCap),this.polygons.forEach((function(t){return t.draw(e)})),this.lines.forEach((function(t){return t.draw(e)})),e.lineWidth=r.options.lineWidth,e.strokeStyle=r.options.strokeColor,this.vertices.forEach((function(t){return t.draw(e)})),this.animStart||(this.animStart=t);var i=Math.floor(t-this.animStart);this.animStart=t,"coalesce"===this.mouse.mode&&!0===this.mouse.clicked?this.points.forEach((function(t){return t.moveToMouse(i)})):this.points.forEach((function(t){n.mouse.clicked&&"destroy"===n.mouse.mode&&n.mouse.near(t)?n._removePoint(t):t.update(i)})),window.requestAnimationFrame(this._drawArt.bind(this))}},{key:"_resizeCanvas",value:function(t,n){var e=this.canvas.el.width,i=this.canvas.el.height;this.canvas.el.height=n,this.canvas.el.width=t,this.modified||this.stretch?this.points.forEach((function(t){return t.stretchToCanvas(e,i)})):this.points.forEach((function(t){return t.scaleToArtboard()}))}},{key:"_installListeners",value:function(){window.addEventListener("resize",function(){this._resizeCanvas(window.innerWidth,window.innerHeight)}.bind(this)),document.addEventListener("pointerdown",function(t){"button"===t.target.localName||"input"===t.target.localName||"label"===t.target.localName||"a"===t.target.localName||t.target.dataset.ignoreClick||(this.mouse.click(t.clientX,t.clientY),"radiate"===this.mouse.mode?this._teleportPoints():"create"===this.mouse.mode&&(this._addNewPoint(t.clientX,t.clientY),this.mouse.setToIgnore(500)))}.bind(this)),document.addEventListener("pointerup",function(){this.mouse.resetPos(),"coalesce"===this.mouse.mode&&this.mouse.setToIgnore()}.bind(this)),document.addEventListener("pointermove",function(t){this.mouse.updatePos(t.clientX,t.clientY)}.bind(this)),document.addEventListener("pointercancel",function(){this.mouse.resetPos()}.bind(this))}}])&&y(n.prototype,e),t}();function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function g(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function k(t,n){return(k=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function x(t,n){return!n||"object"!==w(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const C=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&k(t,n)}(h,t);var n,e,o,s,a=(o=h,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=_(o);if(s){var e=_(this).constructor;t=Reflect.construct(n,arguments,e)}else t=n.apply(this,arguments);return x(this,t)});function h(){return b(this,h),a.apply(this,arguments)}return n=h,(e=[{key:"_drawArt",value:function(){var t=this.canvas.ctx;t.clearRect(0,0,this.canvas.el.width,this.canvas.el.height),t.lineWidth=c.options.lineWidth,t.strokeStyle=c.options.strokeColor,t.fillStyle=c.options.fillColor,this.polygons.forEach((function(n){return n.draw(t)})),this.lines.forEach((function(n){return n.draw(t)})),t.lineWidth=r.options.lineWidth,t.strokeStyle=r.options.strokeColor,this.vertices.forEach((function(n){return n.draw(t)})),this.vertices.forEach((function(n){return n.label(t)}))}},{key:"_addNewPoint",value:function(t,n){var e=new i(t,n,this.points.length,this.canvas,this.mouse);this.points.push(e),this.vertices.push(new r(e))}},{key:"_showPoints",value:function(){var t=this,n=document.createElement("p");n.style.backgroundColor="white",n.style.color="black",n.style.border="2px solid black",n.style.position="absolute",n.style.top=0,n.style.zIndex=10,n.style.padding="25px",n.style.width="100px",n.style.maxHeight="80vh",n.style.overflow="scroll";var e="{\n";this.points.forEach((function(n,i){var o=Math.round(n.cx/t.canvas.el.width*100),s=Math.round(n.cy/t.canvas.el.height*100);e+="".concat(i,": [").concat(o,", ").concat(s,"],\n")})),e+="};",n.innerText=e,document.body.appendChild(n)}},{key:"_installListeners",value:function(){window.addEventListener("resize",function(){this._resizeCanvas(window.innerWidth,window.innerHeight)}.bind(this)),document.addEventListener("click",function(t){this._addNewPoint(t.clientX,t.clientY),this._drawArt()}.bind(this)),document.addEventListener("keydown",function(t){"Enter"===t.code&&this._showPoints()}.bind(this))}}])&&g(n.prototype,e),h}(m);window.initConstellation=function(t,n){return new m(t,n)},window.initCreateConstellation=function(t,n){return new C(t,n)}})();