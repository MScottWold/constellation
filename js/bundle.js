(()=>{"use strict";var t={points:{0:[70,23],1:[72,23],2:[74,25],3:[75,28],4:[78,36],5:[78,39],6:[67,46],7:[60,45],8:[58,59],9:[72,68],10:[80,85],11:[86,65],12:[84,64],13:[73,61],14:[73,64],15:[54,59],16:[47,56],17:[47,53],18:[42,42],19:[44,37],20:[23,14],21:[19,15],22:[13,19],23:[11,29],24:[7,27],25:[6,39],26:[10,39],27:[7,94],28:[12,83],29:[17,81],30:[23,78],31:[30,66],32:[32,74],33:[26,83],34:[0,4],35:[21,40],36:[26,34],37:[30,42],38:[32,17],39:[40,4],40:[46,20],41:[58,8],42:[69,6],43:[86,24],44:[89,9],45:[98,31],46:[88,40],47:[97,57],48:[91,81],49:[96,88],50:[70,97],51:[69,82],52:[58,78],53:[59,92],54:[48,72],55:[47,87],56:[40,80],57:[32,92],58:[3,79],59:[16,60],60:[13,54],61:[9,5]},lines:[[0,1],[1,2],[2,3],[3,4],[4,5],[2,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,6],[9,14],[14,13],[8,15],[15,16],[16,18],[16,17],[17,19],[20,21],[21,22],[22,23],[23,24],[24,25],[25,26],[26,23],[27,28],[28,29],[29,30],[30,31],[31,32],[32,33],[33,30]],polygons:[],options:{vertices:{strokeColor:"#1F2833",fillColor:"#66FCF1",altFillColor:"#B41A4E",lineWidth:2,radius:4},shapes:{strokeColor:"#1F2833",fillColor:"#2C5F5D",lineWidth:2},scaleDown:{maxWidth:380,factor:2},noScale:!0}},i={points:{},lines:[],polygons:[]};function e(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=new Array(i);e<i;e++)n[e]=t[e];return n}function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(i,e,n,o,s){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialX=this.x=this.cx=i,this.initialY=this.y=this.cy=e,this.id=n,this.canvas=o,this.mouse=s,this.wander=!0,this.rad=2*Math.PI/45*(Math.floor(45*Math.random())+1)}var i,o;return i=t,(o=[{key:"update",value:function(t){var i=this._distanceTo(this.mouse.x,this.mouse.y);this.mouse.x&&i<100&&!this.mouse.ignore?this.moveToMouse(t,i):this.wander?this._wander(t):this._returnToCenter(t)}},{key:"moveToMouse",value:function(i,e){var n,o,s=e||this._distanceTo(this.mouse.x,this.mouse.y);if(this.wander=!1,s<1)n=0,o=0;else{var r=9/s;n=-r*(this.x-this.mouse.x),o=-r*(this.y-this.mouse.y)}var a=t.speed*Math.min(i,33);this.x=this.x+n*a,this.y=this.y+o*a}},{key:"jumpToMouse",value:function(){this.x=this.mouse.x,this.y=this.mouse.y,this.wander=!1}},{key:"stretchToCanvas",value:function(t,i){var e=this.canvas.el.width,n=this.canvas.el.height;this.cx=this.cx/t*e,this.x=this.cx,this.cy=this.cy/i*n,this.y=this.cy}},{key:"scaleToArtboard",value:function(){var t=this.canvas.el.width,i=this.canvas.el.height,e=Math.min(t,i),n=this.initialX/100*e;t>i&&(n+=(t-i)/2);var o=this.initialY/100*e;i>t&&(o+=(i-t)/2),this.x=this.cx=n,this.y=this.cy=o}},{key:"twoClosestPoints",value:function(t){if(t.length<=2)return function(t){if(Array.isArray(t))return e(t)}(i=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,i){if(t){if("string"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var i,n,o,s=t[0],r=this._distanceTo(s.x,s.y),a=t[1],h=this._distanceTo(a.x,a.y);if(r>h){var l=[a,s];s=l[0],a=l[1];var c=[h,r];r=c[0],h=c[1]}for(var u=2;u<t.length;u++)n=t[u],(o=this._distanceTo(n.x,n.y))<r?(a=s,h=r,s=n,r=o):o<h&&(a=n,h=o);return[s,a]}},{key:"_wander",value:function(i){var e=this._distanceTo(this.cx,this.cy)<t.range&&Math.random()>.5?t.turnRadius:-t.turnRadius;this.rad=this.rad+e;var n=Math.cos(this.rad),o=Math.sin(this.rad),s=t.speed*Math.min(i,33);this.x=this.x+n*s,this.y=this.y+o*s}},{key:"_returnToCenter",value:function(i){var e=this._distanceTo(this.cx,this.cy),n=18/e,o=t.speed*Math.min(i,33),s=-n*(this.x-this.cx),r=-n*(this.y-this.cy);this.x=this.x+s*o,this.y=this.y+r*o,e<.25*t.range&&(this.wander=!0,this.rad=2*Math.PI/45*(Math.floor(45*Math.random())+1))}},{key:"_distanceTo",value:function(t,i){var e=Math.pow(this.x-t,2),n=Math.pow(this.y-i,2);return Math.sqrt(e+n)}}])&&n(i.prototype,o),t}();o.speed=.01,o.range=50,o.turnRadius=2*Math.PI/45;const s=o;function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.point=i}var i,e;return i=t,(e=[{key:"draw",value:function(i){i.beginPath(),i.arc(this.point.x,this.point.y,t.options.radius,0,2*Math.PI,!1),i.closePath(),this.point.wander?i.fillStyle=t.options.fillColor:i.fillStyle=t.options.altFillColor,i.fill(),i.stroke()}},{key:"label",value:function(t){t.beginPath(),t.font="12px Arial",t.fillStyle="black",t.fillText(this.point.id,this.point.x-3,this.point.y+13)}}])&&r(i.prototype,e),t}();a.options={fillColor:"white",altFillColor:"black",strokeColor:"black",radius:4};const h=a;function l(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function c(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(i,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l(this,t),i[0]instanceof s?this.points=i:this.points=i.map((function(t){return e[t]})),this.polygon=n}var i,e;return i=t,(e=[{key:"draw",value:function(t){t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var i=1;i<this.points.length;i++)t.lineTo(this.points[i].x,this.points[i].y);this.polygon?(t.closePath(),t.fill()):t.stroke()}},{key:"removePoint",value:function(t){this.points=this.points.filter((function(i){return i!==t}))}}])&&c(i.prototype,e),t}();u.options={strokeColor:"black",fillColor:"white",lineWidth:2};const d=u;function f(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}const v=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.x,this.y,this.mode="default",this.clicked=!1,this.ignore=!1}var i,e;return i=t,(e=[{key:"resetPos",value:function(){this.x=null,this.y=null,this.clicked=!1}},{key:"updatePos",value:function(t,i){this.x=t,this.y=i}},{key:"click",value:function(t,i){this.x=t,this.y=i,this.clicked=!0}},{key:"setToIgnore",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.ignore=!0,this.ignoreTimeout&&clearTimeout(this.ignoreTimeout),this.ignoreTimeout=setTimeout((function(){return t.ignore=!1}),i)}},{key:"near",value:function(t){var i=Math.pow(this.x-t.x,2),e=Math.pow(this.y-t.y,2);return Math.sqrt(i+e)<100}}])&&f(i.prototype,e),t}();function p(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?p(Object(e),!0).forEach((function(i){m(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function m(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function g(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function w(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}const b=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;g(this,t),this.canvas={},this.mouse=new v,this.modified=!1,this.noScale=n.options.noScale,this._initCanvas(e),this._initShapes(n),this._installListeners(),window.requestAnimationFrame(this._drawArt.bind(this))}var e,n;return e=t,(n=[{key:"changeMouseMode",value:function(t){this.mouse.mode=t}},{key:"toggleLines",value:function(){this.lines=[],this.noLines=!this.noLines}},{key:"resetArtboard",value:function(t){this._initShapes(t),this.modified=!1,this.noLines=!1}},{key:"_removePoint",value:function(t){this.points=this.points.filter((function(i){return i!==t})),this.vertices=this.vertices.filter((function(i){return i.point!==t})),this.lines.forEach((function(i){return i.removePoint(t)})),this.lines=this.lines.filter((function(t){return t.points.length>1})),this.polygons.forEach((function(i){return i.removePoint(t)})),this.polygons=this.polygons.filter((function(t){return t.points.length>2}))}},{key:"_addNewPoint",value:function(t,i){var e=this;this.modified=!0;var n=this.points.length>=1?this.points[this.points.length-1].id+1:0,o=new s(t,i,n,this.canvas,this.mouse);if(this.noLines)return this.points.push(o),void this.vertices.push(new h(o));var r=o.twoClosestPoints(this.points);this.points.push(o),this.vertices.push(new h(o)),r.forEach((function(t){e.lines.push(new d([t,o],e.points))}))}},{key:"_teleportPoints",value:function(){this.mouse.setToIgnore(),this.points.forEach((function(t){return t.jumpToMouse()}))}},{key:"_initCanvas",value:function(t){this.canvas.el=document.getElementById(t),this.canvas.el.width=window.innerWidth,this.canvas.el.height=window.innerHeight,this.canvas.ctx=this.canvas.el.getContext("2d")}},{key:"_initShapes",value:function(t){var i=this,e=t.points,n=t.lines,o=t.polygons,r=t.options;for(var a in r&&this._setShapeOptions(r),this.vertices=[],this.points=[],e){var l=new s(e[a][0],e[a][1],Number(a),this.canvas,this.mouse);this.noScale?l.stretchToCanvas(100,100):l.scaleToArtboard(),this.points.push(l),this.vertices.push(new h(l))}this.lines=n.map((function(t){return new d(t,i.points)})),this.polygons=o.map((function(t){return new d(t,i.points,!0)}))}},{key:"_setShapeOptions",value:function(t){var i=t.scaleDown,e=t.vertices,n=t.shapes;if(h.options=y({},t.vertices),d.options=y({},t.shapes),i&&window.innerWidth<i.maxWidth){var o=i.factor;h.options.lineWidth=e.lineWidth/o,h.options.radius=e.radius/o,d.options.lineWidth=n.lineWidth/o}}},{key:"_drawArt",value:function(t){var i=this,e=this.canvas.ctx;e.clearRect(0,0,this.canvas.el.width,this.canvas.el.height),e.lineWidth=d.options.lineWidth,e.strokeStyle=d.options.strokeColor,e.fillStyle=d.options.fillColor,this.polygons.forEach((function(t){return t.draw(e)})),this.lines.forEach((function(t){return t.draw(e)})),e.lineWidth=h.options.lineWidth,e.strokeStyle=h.options.strokeColor,this.vertices.forEach((function(t){return t.draw(e)})),this.animStart||(this.animStart=t);var n=Math.floor(t-this.animStart);this.animStart=t,"coalesce"===this.mouse.mode&&!0===this.mouse.clicked?this.points.forEach((function(t){return t.moveToMouse(n)})):this.points.forEach((function(t){i.mouse.clicked&&"destroy"===i.mouse.mode&&i.mouse.near(t)?i._removePoint(t):t.update(n)})),window.requestAnimationFrame(this._drawArt.bind(this))}},{key:"_resizeCanvas",value:function(t,i){var e=this.canvas.el.width,n=this.canvas.el.height;this.canvas.el.height=i,this.canvas.el.width=t,window.innerWidth<768||(this.modified||this.noScale?this.points.forEach((function(t){return t.stretchToCanvas(e,n)})):this.points.forEach((function(t){return t.scaleToArtboard()})))}},{key:"_installListeners",value:function(){window.addEventListener("resize",function(){this._resizeCanvas(window.innerWidth,window.innerHeight)}.bind(this)),document.addEventListener("pointerdown",function(t){"button"===t.target.localName||"input"===t.target.localName||"label"===t.target.localName||"a"===t.target.localName||t.target.dataset.ignoreClick||(this.mouse.click(t.clientX,t.clientY),"radiate"===this.mouse.mode?this._teleportPoints():"create"===this.mouse.mode&&(this._addNewPoint(t.clientX,t.clientY),this.mouse.setToIgnore(500)))}.bind(this)),document.addEventListener("pointerup",function(){this.mouse.resetPos(),"coalesce"===this.mouse.mode&&this.mouse.setToIgnore()}.bind(this)),document.addEventListener("pointermove",function(t){this.mouse.updatePos(t.clientX,t.clientY)}.bind(this)),document.addEventListener("pointercancel",function(){this.mouse.resetPos()}.bind(this))}}])&&w(e.prototype,n),t}();$((function(){({constellation:new b("background-canvas",t),$viewCtrPanelButton:$("#view-ctr-panel"),$bkgdButtons:$("#bkgd-buttons"),$modeButtons:$("#bkgd-modes button"),hideLinesOption:document.getElementById("hide-lines"),_hideControls:function(){this.$viewCtrPanelButton.removeClass("active").html("&xdtri;"),this.$bkgdButtons.removeClass("show")},_toggleCtrPanel:function(t){var i=$(t.currentTarget);i.toggleClass("active"),i.is(".active")?i.html("&xutri;"):i.html("&xdtri;"),this.$bkgdButtons.toggleClass("show")},_changeMode:function(i){var e=$(i.currentTarget);this.constellation.changeMouseMode(e.data("bkgdMode")),this.$modeButtons.removeClass("active"),e.addClass("active"),"default"===e.data("bkgdMode")&&(this.constellation.resetArtboard(t),this.hideLinesOption.checked=!1),this._hideControls()},init:function(){var t=this;this.$viewCtrPanelButton.on("click",this._toggleCtrPanel.bind(this)),$("#bkgd-modes").on("click","button",this._changeMode.bind(this)),this.hideLinesOption.addEventListener("click",(function(){t.constellation.toggleLines()}))}}).init()}))})();